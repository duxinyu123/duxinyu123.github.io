---
layout:     post                    # 使用的布局（不需要改）
title:      mysql基础(三)    				# 标题 		  
subtitle:   视图、事务	 		#副标题
date:       2021-01-21              # 时间
author:     新宇                     # 作者
header-img: img/post-bg-2015.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    - 数据库
---
# 一、外键
## 1. 概念
一个表的主键A在另外一个表B中出现，则A是表B的外键
## 2. 作用
- 本身也是约束，为了防止无效信息插入
- 但会降低表的更新效率，一般很少使用

## 3. 语法
```sql
-- 外键的使用

-- 向goods表里插入任意一条数据
insert into goods (name,cate_id,brand_id,price) values('老王牌拖拉机', 10, 10,'6666');

-- 创建外键第一种方式：通过alter table
-- 约束 数据的插入 使用 外键 foreign key
-- alter table goods add foreign key (brand_id) references goods_brands(id);
alter table goods add foreign key(cate_id) references goods_cates(id); 
alter table goods add foreign key(brand_id) references goods_brands(id);	

-- 创建外键第二种方式：create table 时创建
create table teacher(
    id int not null primary key auto_increment, 
    name varchar(10), 
    s_id int not null, 
    foreign key(s_id) references school(id)
);

-- 失败原因 老王牌拖拉机 delete
-- delete from goods where name="老王牌拖拉机";
delete from goods where name="老王牌拖拉机";

-- 如何取消外键约束
-- 需要先获取外键约束名称,该名称系统会自动生成,可以通过查看表创建语句来获取名称
show create table goods;

-- 获取名称之后就可以根据名称来删除外键约束
alter table goods drop foreign key goods_ibfk_1;
alter table goods drop foreign key goods_ibfk_2;
```


# 二、视图
## 1. 概念
![](https://tva1.sinaimg.cn/large/008eGmZEly1gmw9j9lmocj30tg07e42l.jpg)
## 2. 语法
```sql
-- 1.创建视图 create view 视图名称 as select语句;
create view v_students as 
select s.id,s.name,s.age,s.gender,c.name as cls_name 
	from students as s 
	inner join classes as c 
	on s.cls_id=c.id;

-- 2.查看视图 show tables
show tables;

-- 3.查询视图 select * from 视图名称
select * from v_students;

-- 4.删除视图 drop view 视图名称
drop view v_students;
```

