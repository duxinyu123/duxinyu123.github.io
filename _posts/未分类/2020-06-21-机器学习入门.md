---
layout:     post                    # 使用的布局（不需要改）
title:      1. 机器学习入门、线性回归              # 标题 
subtitle:   机器学习算法总结、jupyter notebook使用教程 #副标题
date:       2020-06-21              # 时间
author:     新宇                      # 作者
header-img: img/post-bg-2015.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    - 杂七杂八
---

>人大在职研修班，讲师：齐文光

# 一、基础概念
![机器学习](https://tva1.sinaimg.cn/large/007S8ZIlly1gg04lmbnbgj307h06lmx6.jpg "机器学习")
1. 机器学习：让计算机具备像人一样的学习能力的技术
2. 分类：
- **监督学习**：主要解决“回归”和“分类”问题；
- **无监督学习**：通过“聚类”的方式组织数据，然后找出数据中存在的内在结构。
- **半监督学习**：输入数据是被标记的和不被标记的数据的混合。
- **强化学习**：一种学习模型，它并不会直接给你解决方案，需要通过试错去找到解决方案，例如 Alphago，强化学习的优点是不受数据限制，未来前景更好。
3. 应用场景：
- 金融
- 网络安全
- 医疗健康
- 智能汽车
4. 相关竞赛
- [kaggle](https://www.kaggle.com/)
- [阿里天池](https://tianchi.aliyun.com/)

# 二、环境搭建(Anaconda 和 Jupyter)

1. **Anaconda**：是一个开源的Python发行版本，其包含了conda、 Python等180多个科学包及其依赖项;
2. 下载路径 
   - [官网下载](https://www.anaconda.com/)
   - [清华镜像](https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/)
3. 安装好Anaconda后，我们就一并安装了conda这个包管理工具；
   ```
   which conda   // 或 conda –version 命令检查是否安装正确。 
   conda list    // 查询
   conda install // 安装
   conda update  // 升级
   conda remove  // 卸载
   ```
4. 启动 Jupyter notebook
   `jupyter notebook`

# 三、机器学习算法
## 1.线性回归
![样本数据](https://tva1.sinaimg.cn/large/007S8ZIlly1gg15ip61i8j30b4073gll.jpg "样本数据")
1. 通过绘制样本数据，可以看出，样本点分布趋紧与一条直线；
2. 使用一阶线性方程来拟合这个数据：y = coef_*x + intercept_ ,通过 LinearRegression 构造线性模型
![线性模型](https://tva1.sinaimg.cn/large/007S8ZIlly1gg15p8dlu3j30cp09g3z3.jpg "线性模型")
3. 而在某些情况下，一阶线性方程并不能很好的拟合数据，例如
![线性模型2](https://tva1.sinaimg.cn/large/007S8ZIlly1gg1bbc62q1j30k40gpwft.jpg "线性模型2")
4. 所以构造二阶函数 f(x) = w1\*x\*\*3 + w2\*x\*\*2 + w3\*x + b，需要通过ploy = PolynomialFeatures(degree=3)来构造线性特征
![二阶模型](https://tva1.sinaimg.cn/large/007S8ZIlly1gg1bfzpcasj30j70k4tao.jpg "二阶模型")
5. 有时我们并不知道几阶函数更适合，假设我们采用十阶函数
![十阶模型](https://tva1.sinaimg.cn/large/007S8ZIlly1gg1bi5jgbfj30k20b00td.jpg "十阶模型")
6. 再多生成一些数据，验证模型的对未知数据的拟合度，可见此模型**过度拟合训练数据，反而对未知数据的预测能力比较差**，我们称为**过拟合**
![十阶模型](https://tva1.sinaimg.cn/large/007S8ZIlly1gg1bjdzfvdj30fu0fugmk.jpg "十阶模型")
7.  为了更好的测试模型的拟合度，可以划分数据集：train 训练，test 测试，默认test数据一般是数据集总数的1/4
```
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error
x = np.linspace(0, 30, 30) # 生成测试数据
y = 3*x**3 + 3000*np.random.randn(30)
x = x.reshape(-1, 1) # 构造列向量
y = y.reshape(-1, 1) 
x_train, x_test, y_train, y_test = train_test_split(x, y) # 划分数据集
ploy2 = PolynomialFeatures(degree=2) # 构造特征
x2 = ploy2.fit_transform(x_train)
model = LinearRegression()
model.fit(x2, y_train)  # 训练数据
print(mean_squared_error(y_train, model.predict(x2))) # 计算均方误差
```
8. 如何找到拟合度最好的阶数？ 可以通过循环测试，找到最小均方误差
```
mss = []
d_array = range(2,11)
scores = []
for d in d_array:
    ploy = PolynomialFeatures(degree=d)
    x = ploy.fit_transform(x_train)
    model = LinearRegression()
    model.fit(x,y_train)
    xt = ploy.fit_transform(x_test) 
    ms = mean_squared_error(model.predict(xt), y_test)
    score = model.score(xt, y_test) # 获取拟合度，越接近1，说明拟合度越好
    mss.append(ms)
    scores.append(score)  
print(mss)
```
![循环测试](https://tva1.sinaimg.cn/large/007S8ZIlly1gg1brcnk4rj30fd0itt9o.jpg "循环测试")

**以下将在后几章节详细介绍**
## 2.逻辑回归（分类问题）
## 3.KNN算法（K-临近算法）
## 4.Kmeans
## 5.DBScan
## 6.决策树与随机森林
## 7.SVM（支持向量机）
## 8.NLP（自然语言处理）
## 9.朴素贝叶斯
## 10.协同过滤

# 四.总结

1. 过拟合：过度拟合训练数据，‘泛化’性能下降，反而对未知数据的预测能力比较差;
2. 欠拟合：对训练数据和潜在数据拟合的都不好；

















